#!/bin/node

const fs = require('fs');
//Obtain the environment string passed to the node script
const environment = process.argv[2];
//read the content of the json file
const envFileContent = require(`../environments/environment.${environment}.json`);
const globalEnvFileContent = require(`../environments/environment.json`);
const finalConfiguration = {
  ...globalEnvFileContent,
  ...envFileContent,
};
//copy the json inside the env.json file
fs.writeFileSync(
  './src/app/constants/Config.ts',
  `/**
* This file is automatically generated by the command, npm run env:local|stage|prod
*
* Changes to this file are not tracked by git.
* To track changes, run:
*    git update-index --no-skip-worktree ./src/config/Config.ts
* 
* Helpful Link: https://stackoverflow.com/a/39776107/3543339
*/

import Config from '../types/Config.d';

const config = ${JSON.stringify(finalConfiguration, undefined, 2).replace(
    /"/g,
    "'",
  )} as Config;

export default config;
`,
);

fs.writeFileSync(
  './src/app/constants/Config.json',
  JSON.stringify(finalConfiguration, undefined, 2),
);
